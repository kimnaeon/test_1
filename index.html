<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>body {padding: 0; margin: 0;}</style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
    <script>
        let particles = [];
        let shakeThreshold = 30;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            window.addEventListener('devicemotion', handleShakeEvent);
        }

        function draw() {
            background(220);
            particles.forEach(particle => {
                particle.update();
                particle.display();
            });
        }

        function handleShakeEvent(event) {
            let acceleration = event.accelerationIncludingGravity;
            if (acceleration.x > shakeThreshold || acceleration.y > shakeThreshold || acceleration.z > shakeThreshold) {
                shakeParticles();
            }
        }

        function shakeParticles() {
            particles.forEach(particle => {
                let force = createVector(random(-5, 5), random(-5, 5));
                particle.applyForce(force);
            });
        }

        class Particle {
            constructor(x, y) {
                this.position = createVector(x, y);
                this.velocity = createVector();
                this.acceleration = createVector();
                this.size = 10;
            }

            applyForce(force) {
                this.acceleration.add(force);
            }

            update() {
                this.velocity.add(this.acceleration);
                this.position.add(this.velocity);
                this.acceleration.mult(0);
            }

            display() {
                noStroke();
                fill(0);
                ellipse(this.position.x, this.position.y, this.size, this.size);
            }
        }

        function mouseClicked() {
            particles.push(new Particle(mouseX, mouseY));
        }
    </script>
</body>
</html>
